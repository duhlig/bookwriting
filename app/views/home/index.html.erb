<!--
<div id="intro"><br/>
  <div class="fltlft"><%= image_tag "cloud.jpg", :height => 150 %></div>
    <h3>Online Book Writing as Cloud Service</h3>
    <h4>Please sign in or sign up to write your own book</h4>
    <div class="clearfloat"> </div>
</div>-->

<h2>Your Books</h2>

<div class="rt"><%= link_to 'New Book', new_book_path %></div>
<div><table style="text-align: left">
  <tr>
    <th>Title</th>
    <th>Abstract</th>
    <th>Authors</th>
    <th>Version</th>
    <th>Updated</th>
    <th>Created</th>
    <th colspan="3">Actions</th>
  </tr>

  <% @books.each do |book| %>
      <tr>
        <td><%= book.title %></td>
        <td><%= raw truncate book.abstract, length: 80 %></td>
        <td><%= book.author_names.join ", " %></td>
        <td><%= book.versions.length + 1 %></td>
        <td><%= book.updated_at %></td>
        <td><%= book.created_at %></td>
        <td class="rt-book"><%= link_to 'Show', book %></td>
        <td class="rt-book"><%= link_to 'Edit', edit_book_path(book) %></td>
        <td class="rt-book">
          <% if book.users.length > 1 %>
              <%= link_to 'Leave Book',  revoke_access_path(book.user_authorship(current_user)), :method => :post %>
          <% else %>
              <%= link_to 'Delete', book, method: :delete, data: { confirm: 'Are you sure?' } %>
          <% end %>
        </td>
      </tr>
  <% end %>

</table>
</div>
